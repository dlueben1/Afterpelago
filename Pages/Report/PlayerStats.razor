@page "/report/players"
@using Afterpelago.Utilities

<article style="display: flex; flex-direction: row; padding: 4em; overflow-y: auto; max-height: 90vh;" Class="mt-16">
    <MudStack Style="width: 100%;">
        <MudExpansionPanels MultiExpansion="true">
            @foreach (var player in Archipelago.Slots)
            {
                <MudExpansionPanel Text="@player.Value.PlayerName">
                    <MudText Typo="Typo.subtitle1">Game: @player.Value.Game.FriendlyName</MudText>
                    <MudGrid>
                        <MudItem xs="12" sm="6">
                            <MudList T="string">
                                <MudListSubheader>
                                    Player Info
                                </MudListSubheader>
                                <MudListItem Text="Total Active Time" SecondaryText="@(player.Value.ActiveTimeOnline.ToReadableString())" />
                                <MudDivider />
                                <MudListSubheader>
                                    Checks
                                </MudListSubheader>
                                <MudListItem Text="Average Checks Per Hour" SecondaryText="@player.Value.ChecksPerHour.ToString("F2")" />
                                <MudListItem Text="Percentage of Checks Found before Release" SecondaryText="@($"{player.Value.PercentageOfChecksBeforeRelease.ToString("F2")}%")" />
                                <MudListItem Text="# of Leftover Checks on Release" SecondaryText="@player.Value.EstimatedChecksFromRelease.ToString()" />
                                <MudListItem Text="First Item Received" SecondaryText="@($"{player.Value.FirstItemReceived?.Name} from {player.Value.FirstItemLogEntry.SenderName}")">
                                    <AvatarContent>
                                        @if(!string.IsNullOrEmpty(player.Value.FirstItemReceived.Img))
                                        {
                                            <img src="@player.Value.FirstItemReceived.ImageEndpoint" width="48" height="48" />
                                        }
                                        else
                                        {
                                            <MudIcon Icon="@Icons.Material.Filled.EmojiEvents" />
                                        }
                                    </AvatarContent>
                                </MudListItem>
                            </MudList>
                        </MudItem>
                        <MudItem xs="12" sm="6">
                            <MudList T="string">
                                <MudListSubheader>
                                    Medals
                                </MudListSubheader>
                                @foreach (var medal in player.Value.Medals)
                                {
                                    <MudListItem Text="@medal.Name" SecondaryText="@medal.Description" Icon="@medal.Icon" />
                                }
                                @if(player.Value.Medals.Count == 0)
                                {
                                    <MudListItem Text="No Medals Earned" />
                                }
                            </MudList>
                        </MudItem>
                    </MudGrid>
                </MudExpansionPanel>
            }
        </MudExpansionPanels>
    </MudStack>
</article>